
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.1">
    
    
      
        <title>Blocks - Thunder</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1118c9be.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ba0d045b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#thunder.blocks" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Thunder" class="md-header__button md-logo" aria-label="Thunder" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Thunder
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Blocks
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/scart97/thunder-speech" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Thunder speech
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Thunder" class="md-nav__button md-logo" aria-label="Thunder" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Thunder
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/scart97/thunder-speech" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Thunder speech
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Ultimate%20guide/" class="md-nav__link">
        The ultimate guide to speech recognition (WIP)
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../quick%20reference%20guide/" class="md-nav__link">
        Quick reference guide
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Api
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Api" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Api
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Blocks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Blocks
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks" class="md-nav__link">
    thunder.blocks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks.SwapLastDimension" class="md-nav__link">
    SwapLastDimension
  </a>
  
    <nav class="md-nav" aria-label="SwapLastDimension">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#thunder.blocks.SwapLastDimension.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks.conv1d_decoder" class="md-nav__link">
    conv1d_decoder()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks.convolution_stft" class="md-nav__link">
    convolution_stft()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks.get_same_padding" class="md-nav__link">
    get_same_padding()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks.linear_decoder" class="md-nav__link">
    linear_decoder()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/" class="md-nav__link">
        Callbacks
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/" class="md-nav__link">
        Metrics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" >
      
      <label class="md-nav__link" for="__nav_4_5">
        Citrinet
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Citrinet" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Citrinet
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Citrinet/blocks/" class="md-nav__link">
        Blocks
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Citrinet/compatibility/" class="md-nav__link">
        Compatibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Citrinet/module/" class="md-nav__link">
        Module
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_6" type="checkbox" id="__nav_4_6" >
      
      <label class="md-nav__link" for="__nav_4_6">
        Data
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Data/dataloader%20utils/" class="md-nav__link">
        Dataloader utils
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Data/datamodule/" class="md-nav__link">
        Datamodule
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Data/dataset/" class="md-nav__link">
        Dataset
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_7" type="checkbox" id="__nav_4_7" >
      
      <label class="md-nav__link" for="__nav_4_7">
        Quartznet
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Quartznet" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_7">
          <span class="md-nav__icon md-icon"></span>
          Quartznet
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Quartznet/blocks/" class="md-nav__link">
        Blocks
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Quartznet/compatibility/" class="md-nav__link">
        Compatibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Quartznet/module/" class="md-nav__link">
        Module
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Quartznet/transform/" class="md-nav__link">
        Transform
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_8" type="checkbox" id="__nav_4_8" >
      
      <label class="md-nav__link" for="__nav_4_8">
        Text Processing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Text Processing" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_8">
          <span class="md-nav__icon md-icon"></span>
          Text Processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Text%20Processing/preprocess/" class="md-nav__link">
        Preprocess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Text%20Processing/tokenize/" class="md-nav__link">
        Tokenize
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Text%20Processing/transform/" class="md-nav__link">
        Transform
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Text%20Processing/vocab/" class="md-nav__link">
        Vocab
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9" type="checkbox" id="__nav_4_9" >
      
      <label class="md-nav__link" for="__nav_4_9">
        Wav2Vec
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Wav2Vec" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_9">
          <span class="md-nav__icon md-icon"></span>
          Wav2Vec
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Wav2Vec/module/" class="md-nav__link">
        Module
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Wav2Vec/transform/" class="md-nav__link">
        Transform
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks" class="md-nav__link">
    thunder.blocks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks.SwapLastDimension" class="md-nav__link">
    SwapLastDimension
  </a>
  
    <nav class="md-nav" aria-label="SwapLastDimension">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#thunder.blocks.SwapLastDimension.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks.conv1d_decoder" class="md-nav__link">
    conv1d_decoder()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks.convolution_stft" class="md-nav__link">
    convolution_stft()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks.get_same_padding" class="md-nav__link">
    get_same_padding()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thunder.blocks.linear_decoder" class="md-nav__link">
    linear_decoder()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Blocks</h1>
                
                <div class="doc doc-object doc-module">

<a id="thunder.blocks"></a>
    <div class="doc doc-contents first">

      <p>Building blocks that can be shared across all models.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h2 id="thunder.blocks.SwapLastDimension" class="doc doc-heading">
        <code>SwapLastDimension</code>



</h2>

    <div class="doc doc-contents ">

      <p>Layer that swap the last two dimensions of the data.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="thunder.blocks.SwapLastDimension.forward" class="doc doc-heading">
<code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<p>.. note::
    Although the recipe for forward pass needs to be defined within
    this function, one should call the :class:<code>Module</code> instance afterwards
    instead of this since the former takes care of running the
    registered hooks while the latter silently ignores them.</p>

        <details class="quote">
          <summary>Source code in <code>thunder/blocks.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="thunder.blocks.conv1d_decoder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">conv1d_decoder</span><span class="p">(</span><span class="n">decoder_input_channels</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Decoder that uses one conv1d layer</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>num_classes</code></td>
        <td><code>int</code></td>
        <td><p>Number of output classes of the model. It's the size of the vocabulary, excluding the blank symbol.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>decoder_input_channels</code></td>
        <td><code>int</code></td>
        <td><p>Number of input channels of the decoder. That is the number of channels of the features created by the encoder.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Module</code></td>
      <td><p>Pytorch model of the decoder</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>thunder/blocks.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">conv1d_decoder</span><span class="p">(</span><span class="n">decoder_input_channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Decoder that uses one conv1d layer</span>

<span class="sd">    Args:</span>
<span class="sd">        num_classes : Number of output classes of the model. It&#39;s the size of the vocabulary, excluding the blank symbol.</span>
<span class="sd">        decoder_input_channels : Number of input channels of the decoder. That is the number of channels of the features created by the encoder.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Pytorch model of the decoder</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">decoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">(</span>
        <span class="n">decoder_input_channels</span><span class="p">,</span>
        <span class="n">num_classes</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">xavier_uniform_</span><span class="p">(</span><span class="n">decoder</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">decoder</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="thunder.blocks.convolution_stft" class="doc doc-heading">
<code class="highlight language-python"><span class="n">convolution_stft</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">n_fft</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">win_length</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.0000e+00</span><span class="p">,</span> <span class="mf">9.4175e-06</span><span class="p">,</span> <span class="mf">3.7730e-05</span><span class="p">,</span>  <span class="o">...</span><span class="p">,</span> <span class="mf">3.7730e-05</span><span class="p">,</span> <span class="mf">9.4175e-06</span><span class="p">,</span><span class="mf">0.0000e+00</span><span class="p">]),</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_complex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Implements the stft operation using the convolution method. This is one alternative
to make possible to export code using this operation to onnx and arm based environments.
The signature shuld follow the same as torch.stft, making it possible to just swap the two.
The code is based on https://github.com/pseeth/torch-stft</p>

        <details class="quote">
          <summary>Source code in <code>thunder/blocks.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">convolution_stft</span><span class="p">(</span>
    <span class="n">input_data</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">hop_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span>
    <span class="n">win_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">hann_window</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="n">center</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_complex</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Implements the stft operation using the convolution method. This is one alternative</span>
<span class="sd">    to make possible to export code using this operation to onnx and arm based environments.</span>
<span class="sd">    The signature shuld follow the same as torch.stft, making it possible to just swap the two.</span>
<span class="sd">    The code is based on https://github.com/pseeth/torch-stft</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">n_fft</span> <span class="o">&gt;=</span> <span class="n">win_length</span>
    <span class="n">pad_amount</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_fft</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">input_data</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

    <span class="n">fourier_basis</span> <span class="o">=</span> <span class="n">_fourier_matrix</span><span class="p">(</span><span class="n">n_fft</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">input_data</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

    <span class="n">cutoff</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">n_fft</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">fourier_basis</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
        <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">fourier_basis</span><span class="p">[:</span><span class="n">cutoff</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">fourier_basis</span><span class="p">[:</span><span class="n">cutoff</span><span class="p">,</span> <span class="p">:])]</span>
    <span class="p">)</span>
    <span class="n">forward_basis</span> <span class="o">=</span> <span class="n">fourier_basis</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>

    <span class="n">window_pad</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_fft</span> <span class="o">-</span> <span class="n">win_length</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">window_pad2</span> <span class="o">=</span> <span class="n">n_fft</span> <span class="o">-</span> <span class="p">(</span><span class="n">window_pad</span> <span class="o">+</span> <span class="n">win_length</span><span class="p">)</span>
    <span class="n">fft_window</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="p">[</span><span class="n">window_pad</span><span class="p">,</span> <span class="n">window_pad2</span><span class="p">])</span>
    <span class="c1"># window the bases</span>
    <span class="n">forward_basis</span> <span class="o">*=</span> <span class="n">fft_window</span>
    <span class="n">forward_basis</span> <span class="o">=</span> <span class="n">forward_basis</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>

    <span class="n">num_batches</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">num_samples</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># similar to librosa, reflect-pad the input</span>
    <span class="n">input_data</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">num_batches</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>

    <span class="n">input_data</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
        <span class="n">input_data</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">pad_amount</span><span class="p">,</span> <span class="n">pad_amount</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;reflect&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">input_data</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">forward_transform</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">conv1d</span><span class="p">(</span>
        <span class="n">input_data</span><span class="p">,</span> <span class="n">forward_basis</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="n">hop_length</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>

    <span class="n">cutoff</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">n_fft</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">real_part</span> <span class="o">=</span> <span class="n">forward_transform</span><span class="p">[:,</span> <span class="p">:</span><span class="n">cutoff</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">imag_part</span> <span class="o">=</span> <span class="n">forward_transform</span><span class="p">[:,</span> <span class="n">cutoff</span><span class="p">:,</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">real_part</span><span class="p">,</span> <span class="n">imag_part</span><span class="p">),</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="thunder.blocks.get_same_padding" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_same_padding</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">dilation</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Calculates the padding size to obtain same padding.
    Same padding means that the output will have the
    shape input_shape / stride. That means, for
    stride = 1 the output shape is the same as the input,
    and stride = 2 gives an output that is half of the
    input shape.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>kernel_size</code></td>
        <td><code>int</code></td>
        <td><p>convolution kernel size. Only tested to be correct with odd values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>stride</code></td>
        <td><code>int</code></td>
        <td><p>convolution stride</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dilation</code></td>
        <td><code>int</code></td>
        <td><p>convolution dilation</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>Only stride or dilation may be greater than 1</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>int</code></td>
      <td><p>padding value to obtain same padding.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>thunder/blocks.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_same_padding</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">stride</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dilation</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Calculates the padding size to obtain same padding.</span>
<span class="sd">        Same padding means that the output will have the</span>
<span class="sd">        shape input_shape / stride. That means, for</span>
<span class="sd">        stride = 1 the output shape is the same as the input,</span>
<span class="sd">        and stride = 2 gives an output that is half of the</span>
<span class="sd">        input shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        kernel_size : convolution kernel size. Only tested to be correct with odd values.</span>
<span class="sd">        stride : convolution stride</span>
<span class="sd">        dilation : convolution dilation</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Only stride or dilation may be greater than 1</span>

<span class="sd">    Returns:</span>
<span class="sd">        padding value to obtain same padding.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">stride</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">dilation</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only stride OR dilation may be greater than 1&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dilation</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">dilation</span> <span class="o">*</span> <span class="p">(</span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">kernel_size</span> <span class="o">//</span> <span class="mi">2</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="thunder.blocks.linear_decoder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">linear_decoder</span><span class="p">(</span><span class="n">decoder_input_channels</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">decoder_dropout</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Decoder that uses a linear layer with dropout</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>decoder_dropout</code></td>
        <td><code>float</code></td>
        <td><p>Amount of dropout to be used in the decoder</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>decoder_input_channels</code></td>
        <td><code>int</code></td>
        <td><p>Number of input channels of the decoder. That is the number of channels of the features created by the encoder.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>num_classes</code></td>
        <td><code>int</code></td>
        <td><p>Number of output classes of the model. It's the size of the vocabulary, excluding the blank symbol.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Module</code></td>
      <td><p>Module that represents the decoder.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>thunder/blocks.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">linear_decoder</span><span class="p">(</span>
    <span class="n">decoder_input_channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">decoder_dropout</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Decoder that uses a linear layer with dropout</span>

<span class="sd">    Args:</span>
<span class="sd">        decoder_dropout: Amount of dropout to be used in the decoder</span>
<span class="sd">        decoder_input_channels : Number of input channels of the decoder. That is the number of channels of the features created by the encoder.</span>
<span class="sd">        num_classes : Number of output classes of the model. It&#39;s the size of the vocabulary, excluding the blank symbol.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Module that represents the decoder.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># SwapLastDimension is necessary to</span>
    <span class="c1"># change from (batch, time, #vocab) to (batch, #vocab, time)</span>
    <span class="c1"># that is expected by the rest of the library</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">decoder_dropout</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">decoder_input_channels</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">),</span>
        <span class="n">SwapLastDimension</span><span class="p">(),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../quick%20reference%20guide/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Quick reference guide" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Quick reference guide
            </div>
          </div>
        </a>
      
      
        
        <a href="../callbacks/" class="md-footer__link md-footer__link--next" aria-label="Next: Callbacks" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Callbacks
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.53c85856.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.716f8af4.min.js"></script>
      
    
  </body>
</html>